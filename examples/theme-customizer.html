<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Theme Customizer - shadcn-html</title>
  <link rel="stylesheet" href="../dist/styles/output.css">
  <style>
    :root {
      --background: 0 0% 100%;
      --foreground: 222.2 84% 4.9%;
      --primary: 222.2 47.6% 11.2%;
      --primary-foreground: 210 40% 98%;
      --secondary: 210 40% 96%;
      --secondary-foreground: 222.2 47.6% 11.2%;
      --destructive: 0 84.2% 60.2%;
      --destructive-foreground: 210 40% 98%;
      --muted: 210 40% 96%;
      --muted-foreground: 215.4 16.3% 46.9%;
      --accent: 217.2 91.2% 59.8%;
      --accent-foreground: 222.2 47.6% 11.2%;
      --border: 214.3 31.8% 91.4%;
      --input: 214.3 31.8% 91.4%;
      --ring: 222.2 84% 4.9%;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: system-ui, -apple-system, sans-serif;
      background-color: hsl(var(--background));
      color: hsl(var(--foreground));
      line-height: 1.5;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 2rem;
    }

    h1 {
      font-size: 2.25rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .subtitle {
      color: hsl(var(--muted-foreground));
      font-size: 1rem;
      margin-bottom: 2rem;
    }

    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-bottom: 2rem;
    }

    @media (max-width: 1024px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }

    .section {
      background: hsl(var(--background));
      border: 1px solid hsl(var(--border));
      border-radius: 0.5rem;
      padding: 1.5rem;
    }

    .section h2 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 1.5rem;
      color: hsl(var(--foreground));
    }

    .color-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .color-item {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .color-label {
      font-size: 0.875rem;
      font-weight: 500;
      color: hsl(var(--foreground));
    }

    .color-input-wrapper {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .color-input {
      width: 60px;
      height: 40px;
      border: 1px solid hsl(var(--border));
      border-radius: 0.375rem;
      cursor: pointer;
    }

    .color-input:focus {
      outline: 2px solid hsl(var(--ring));
      outline-offset: 2px;
    }

    .color-value {
      flex: 1;
      padding: 0.5rem;
      background: hsl(var(--muted));
      border: 1px solid hsl(var(--border));
      border-radius: 0.375rem;
      font-size: 0.875rem;
      font-family: monospace;
      color: hsl(var(--foreground));
    }

    .button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.5rem 1rem;
      background: hsl(var(--primary));
      color: hsl(var(--primary-foreground));
      border: none;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .button:hover {
      background: hsl(var(--primary) / 0.9);
    }

    .button:focus-visible {
      outline: 2px solid hsl(var(--ring));
      outline-offset: 2px;
    }

    .button.secondary {
      background: hsl(var(--secondary));
      color: hsl(var(--secondary-foreground));
    }

    .button.secondary:hover {
      background: hsl(var(--secondary) / 0.8);
    }

    .button-group {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      margin-bottom: 1.5rem;
    }

    .preview {
      background: hsl(var(--background));
      border: 1px solid hsl(var(--border));
      border-radius: 0.5rem;
      padding: 1.5rem;
    }

    .preview h3 {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: hsl(var(--foreground));
    }

    .preview-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .preview-swatch {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
    }

    .swatch {
      width: 100%;
      height: 60px;
      border-radius: 0.375rem;
      border: 1px solid hsl(var(--border));
    }

    .swatch-label {
      font-size: 0.75rem;
      text-align: center;
      color: hsl(var(--muted-foreground));
      word-break: break-word;
    }

    .code-block {
      background: hsl(var(--muted));
      border: 1px solid hsl(var(--border));
      border-radius: 0.375rem;
      padding: 1rem;
      font-family: monospace;
      font-size: 0.875rem;
      color: hsl(var(--foreground));
      overflow-x: auto;
      margin-bottom: 1rem;
    }

    .code-block code {
      white-space: pre;
    }

    .tabs {
      display: flex;
      gap: 0.5rem;
      border-bottom: 1px solid hsl(var(--border));
      margin-bottom: 1rem;
      overflow-x: auto;
    }

    .tab-button {
      padding: 0.75rem 1rem;
      background: transparent;
      border: none;
      border-bottom: 2px solid transparent;
      color: hsl(var(--muted-foreground));
      cursor: pointer;
      font-size: 0.875rem;
      font-weight: 500;
      transition: all 0.2s;
    }

    .tab-button.active {
      color: hsl(var(--foreground));
      border-bottom-color: hsl(var(--primary));
    }

    .tab-button:hover {
      color: hsl(var(--foreground));
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .input-group {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .input-group input {
      flex: 1;
      padding: 0.5rem;
      border: 1px solid hsl(var(--border));
      border-radius: 0.375rem;
      font-size: 0.875rem;
    }

    .input-group input:focus {
      outline: 2px solid hsl(var(--ring));
      outline-offset: 2px;
    }

    .preset-buttons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.5rem;
      margin-bottom: 1.5rem;
    }

    .preset-button {
      padding: 0.75rem;
      background: hsl(var(--secondary));
      color: hsl(var(--secondary-foreground));
      border: 1px solid hsl(var(--border));
      border-radius: 0.375rem;
      cursor: pointer;
      font-size: 0.875rem;
      text-align: left;
      transition: all 0.2s;
    }

    .preset-button:hover {
      background: hsl(var(--muted));
    }

    .copy-button {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      padding: 0.25rem 0.5rem;
      background: hsl(var(--primary));
      color: hsl(var(--primary-foreground));
      border: none;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      cursor: pointer;
    }

    .code-block {
      position: relative;
    }

    .alert {
      padding: 1rem;
      border-radius: 0.375rem;
      margin-bottom: 1rem;
      border-left: 4px solid;
    }

    .alert-success {
      background: hsl(142 76% 36% / 0.1);
      border-left-color: hsl(142 76% 36%);
      color: hsl(142 76% 36%);
    }

    .dark-mode-toggle {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: hsl(var(--primary));
      color: hsl(var(--primary-foreground));
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transition: all 0.2s;
    }

    .dark-mode-toggle:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
    }

    .dark-mode-toggle:focus-visible {
      outline: 2px solid hsl(var(--ring));
      outline-offset: 2px;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --background: 222.2 84% 4.9%;
        --foreground: 210 40% 98%;
        --primary: 210 40% 98%;
        --primary-foreground: 222.2 47.6% 11.2%;
        --secondary: 217.2 32.6% 17.5%;
        --secondary-foreground: 210 40% 98%;
        --destructive: 0 84.2% 60.2%;
        --destructive-foreground: 210 40% 98%;
        --muted: 217.2 32.6% 17.5%;
        --muted-foreground: 215 20.3% 65.1%;
        --accent: 217.2 91.2% 59.8%;
        --accent-foreground: 222.2 47.6% 11.2%;
        --border: 217.2 32.6% 17.5%;
        --input: 217.2 32.6% 17.5%;
        --ring: 210 40% 98%;
      }

      html.dark {
        color-scheme: dark;
      }
    }

    html.dark {
      --background: 222.2 84% 4.9%;
      --foreground: 210 40% 98%;
      --primary: 210 40% 98%;
      --primary-foreground: 222.2 47.6% 11.2%;
      --secondary: 217.2 32.6% 17.5%;
      --secondary-foreground: 210 40% 98%;
      --muted: 217.2 32.6% 17.5%;
      --muted-foreground: 215 20.3% 65.1%;
      --border: 217.2 32.6% 17.5%;
      --input: 217.2 32.6% 17.5%;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸŽ¨ Theme Customizer</h1>
    <p class="subtitle">Create and export custom themes for shadcn-html components</p>

    <div class="grid">
      <!-- Color Editor -->
      <div class="section">
        <h2>Color Editor</h2>

        <div class="button-group">
          <button class="button" onclick="loadPreset('default')">Default Theme</button>
          <button class="button secondary" onclick="loadPreset('blue')">Blue Theme</button>
          <button class="button secondary" onclick="loadPreset('green')">Green Theme</button>
          <button class="button secondary" onclick="loadPreset('purple')">Purple Theme</button>
        </div>

        <div id="colorEditor" class="color-grid">
          <!-- Colors will be generated here by JavaScript -->
        </div>
      </div>

      <!-- Preview -->
      <div class="section">
        <h2>Live Preview</h2>

        <div class="preview">
          <h3>Color Swatches</h3>
          <div id="colorPreview" class="preview-grid">
            <!-- Swatches will be generated here -->
          </div>

          <h3>Components Preview</h3>
          <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
            <button class="button">Default Button</button>
            <button class="button secondary">Secondary Button</button>
            <button class="button" style="background: hsl(var(--destructive)); color: hsl(var(--destructive-foreground));">Destructive</button>
            <input type="text" placeholder="Text input" style="padding: 0.5rem; border: 1px solid hsl(var(--border)); border-radius: 0.375rem; background: hsl(var(--background)); color: hsl(var(--foreground));" />
          </div>

          <div style="margin-top: 1rem; padding: 1rem; background: hsl(var(--accent) / 0.1); border-left: 4px solid hsl(var(--accent)); border-radius: 0.375rem;">
            <strong>Accent Message:</strong> This shows the accent color in action
          </div>
        </div>
      </div>
    </div>

    <!-- Export Section -->
    <div class="section">
      <h2>Export Theme</h2>

      <div class="tabs">
        <button class="tab-button active" onclick="switchTab('css')">CSS Variables</button>
        <button class="tab-button" onclick="switchTab('tailwind')">Tailwind Config</button>
        <button class="tab-button" onclick="switchTab('json')">JSON</button>
      </div>

      <div id="css" class="tab-content active">
        <div class="code-block">
          <button class="copy-button" onclick="copyToClipboard('css')">Copy</button>
          <code id="cssOutput"></code>
        </div>
      </div>

      <div id="tailwind" class="tab-content">
        <div class="code-block">
          <button class="copy-button" onclick="copyToClipboard('tailwind')">Copy</button>
          <code id="tailwindOutput"></code>
        </div>
      </div>

      <div id="json" class="tab-content">
        <div class="code-block">
          <button class="copy-button" onclick="copyToClipboard('json')">Copy</button>
          <code id="jsonOutput"></code>
        </div>
      </div>

      <div class="button-group">
        <button class="button" onclick="downloadTheme()">ðŸ“¥ Download Theme</button>
        <button class="button secondary" onclick="saveTheme()">ðŸ’¾ Save as Preset</button>
        <button class="button secondary" onclick="resetTheme()">â†» Reset to Default</button>
      </div>

      <div id="alert" style="display: none;"></div>
    </div>
  </div>

  <button class="dark-mode-toggle" onclick="toggleDarkMode()" title="Toggle dark mode" aria-label="Toggle dark mode">
    <span id="darkModeIcon">ðŸŒ™</span>
  </button>

  <script>
    // Theme data
    const themes = {
      default: {
        background: '0 0% 100%',
        foreground: '222.2 84% 4.9%',
        primary: '222.2 47.6% 11.2%',
        'primary-foreground': '210 40% 98%',
        secondary: '210 40% 96%',
        'secondary-foreground': '222.2 47.6% 11.2%',
        destructive: '0 84.2% 60.2%',
        'destructive-foreground': '210 40% 98%',
        muted: '210 40% 96%',
        'muted-foreground': '215.4 16.3% 46.9%',
        accent: '217.2 91.2% 59.8%',
        'accent-foreground': '222.2 47.6% 11.2%',
        border: '214.3 31.8% 91.4%',
        input: '214.3 31.8% 91.4%',
        ring: '222.2 84% 4.9%'
      },
      blue: {
        background: '0 0% 100%',
        foreground: '222.2 84% 4.9%',
        primary: '217.2 91.2% 59.8%',
        'primary-foreground': '222.2 47.6% 11.2%',
        secondary: '210 40% 96%',
        'secondary-foreground': '222.2 47.6% 11.2%',
        destructive: '0 84.2% 60.2%',
        'destructive-foreground': '210 40% 98%',
        muted: '210 40% 96%',
        'muted-foreground': '215.4 16.3% 46.9%',
        accent: '217.2 91.2% 59.8%',
        'accent-foreground': '222.2 47.6% 11.2%',
        border: '214.3 31.8% 91.4%',
        input: '214.3 31.8% 91.4%',
        ring: '217.2 91.2% 59.8%'
      },
      green: {
        background: '0 0% 100%',
        foreground: '222.2 84% 4.9%',
        primary: '142 76% 36%',
        'primary-foreground': '210 40% 98%',
        secondary: '210 40% 96%',
        'secondary-foreground': '222.2 47.6% 11.2%',
        destructive: '0 84.2% 60.2%',
        'destructive-foreground': '210 40% 98%',
        muted: '210 40% 96%',
        'muted-foreground': '215.4 16.3% 46.9%',
        accent: '142 76% 36%',
        'accent-foreground': '210 40% 98%',
        border: '214.3 31.8% 91.4%',
        input: '214.3 31.8% 91.4%',
        ring: '142 76% 36%'
      },
      purple: {
        background: '0 0% 100%',
        foreground: '222.2 84% 4.9%',
        primary: '262.1 80% 50.6%',
        'primary-foreground': '210 40% 98%',
        secondary: '210 40% 96%',
        'secondary-foreground': '222.2 47.6% 11.2%',
        destructive: '0 84.2% 60.2%',
        'destructive-foreground': '210 40% 98%',
        muted: '210 40% 96%',
        'muted-foreground': '215.4 16.3% 46.9%',
        accent: '262.1 80% 50.6%',
        'accent-foreground': '210 40% 98%',
        border: '214.3 31.8% 91.4%',
        input: '214.3 31.8% 91.4%',
        ring: '262.1 80% 50.6%'
      }
    };

    let currentTheme = { ...themes.default };

    // Initialize
    function init() {
      renderColorEditor();
      updatePreview();
      updateExports();
      loadThemeFromStorage();
      updateDarkModeIcon();
    }

    // Render color editor
    function renderColorEditor() {
      const editor = document.getElementById('colorEditor');
      editor.innerHTML = '';

      Object.entries(currentTheme).forEach(([key, value]) => {
        const [h, s, l] = value.split(' ');
        const rgb = hslToRgb(h, s, l);

        const item = document.createElement('div');
        item.className = 'color-item';
        item.innerHTML = `
          <label class="color-label">${key}</label>
          <div class="color-input-wrapper">
            <input type="color" class="color-input" value="${rgbToHex(rgb)}"
                   onchange="updateColor('${key}', this.value)" />
            <input type="text" class="color-value" value="${value}"
                   onchange="updateColor('${key}', this.value)" readonly />
          </div>
        `;
        editor.appendChild(item);
      });
    }

    // Update color
    function updateColor(key, value) {
      if (value.startsWith('#')) {
        const [h, s, l] = hexToHsl(value);
        currentTheme[key] = `${h} ${s}% ${l}%`;
      } else {
        currentTheme[key] = value;
      }

      applyTheme();
      renderColorEditor();
      updatePreview();
      updateExports();
    }

    // Apply theme
    function applyTheme() {
      const root = document.documentElement;
      Object.entries(currentTheme).forEach(([key, value]) => {
        root.style.setProperty(`--${key}`, value);
      });
    }

    // Update preview
    function updatePreview() {
      const preview = document.getElementById('colorPreview');
      preview.innerHTML = '';

      Object.entries(currentTheme).forEach(([key, value]) => {
        const swatch = document.createElement('div');
        swatch.className = 'preview-swatch';
        swatch.innerHTML = `
          <div class="swatch" style="background: hsl(${value});"></div>
          <div class="swatch-label">${key}</div>
        `;
        preview.appendChild(swatch);
      });
    }

    // Update exports
    function updateExports() {
      // CSS Variables
      let css = ':root {\n';
      Object.entries(currentTheme).forEach(([key, value]) => {
        css += `  --${key}: ${value};\n`;
      });
      css += '}';
      document.getElementById('cssOutput').textContent = css;

      // Tailwind Config
      let tailwind = 'colors: {\n';
      Object.entries(currentTheme).forEach(([key, value]) => {
        const hexColor = hslToHex(...value.split(' ').map((v, i) => i === 0 ? v : parseInt(v)));
        tailwind += `  '${key}': '${hexColor}',\n`;
      });
      tailwind += '}';
      document.getElementById('tailwindOutput').textContent = tailwind;

      // JSON
      const json = JSON.stringify(currentTheme, null, 2);
      document.getElementById('jsonOutput').textContent = json;
    }

    // Switch tab
    function switchTab(tabName) {
      document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
      document.querySelectorAll('.tab-button').forEach(el => el.classList.remove('active'));

      document.getElementById(tabName).classList.add('active');
      event.target.classList.add('active');
    }

    // Copy to clipboard
    function copyToClipboard(tabName) {
      const element = document.getElementById(
        tabName === 'css' ? 'cssOutput' :
        tabName === 'tailwind' ? 'tailwindOutput' : 'jsonOutput'
      );
      navigator.clipboard.writeText(element.textContent).then(() => {
        showAlert('âœ“ Copied to clipboard!', 'success');
      });
    }

    // Download theme
    function downloadTheme() {
      const css = document.getElementById('cssOutput').textContent;
      const blob = new Blob([css], { type: 'text/css' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'theme.css';
      a.click();
      URL.revokeObjectURL(url);
      showAlert('âœ“ Theme downloaded!', 'success');
    }

    // Save theme
    function saveTheme() {
      const name = prompt('Theme name:', 'My Theme');
      if (name) {
        localStorage.setItem(`theme_${name}`, JSON.stringify(currentTheme));
        showAlert(`âœ“ Theme "${name}" saved!`, 'success');
      }
    }

    // Load theme
    function loadTheme(name) {
      const theme = localStorage.getItem(`theme_${name}`);
      if (theme) {
        currentTheme = JSON.parse(theme);
        applyTheme();
        renderColorEditor();
        updatePreview();
        updateExports();
      }
    }

    // Load preset
    function loadPreset(name) {
      currentTheme = { ...themes[name] };
      applyTheme();
      renderColorEditor();
      updatePreview();
      updateExports();
    }

    // Reset theme
    function resetTheme() {
      currentTheme = { ...themes.default };
      applyTheme();
      renderColorEditor();
      updatePreview();
      updateExports();
    }

    // Show alert
    function showAlert(message, type) {
      const alert = document.getElementById('alert');
      alert.className = `alert alert-${type}`;
      alert.textContent = message;
      alert.style.display = 'block';
      setTimeout(() => { alert.style.display = 'none'; }, 3000);
    }

    // Save theme to storage
    function saveThemeToStorage() {
      localStorage.setItem('currentTheme', JSON.stringify(currentTheme));
    }

    // Load theme from storage
    function loadThemeFromStorage() {
      const saved = localStorage.getItem('currentTheme');
      if (saved) {
        currentTheme = JSON.parse(saved);
        applyTheme();
        renderColorEditor();
        updatePreview();
        updateExports();
      }
    }

    // Dark mode
    function toggleDarkMode() {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
      updateDarkModeIcon();
    }

    function updateDarkModeIcon() {
      const isDark = document.documentElement.classList.contains('dark');
      document.getElementById('darkModeIcon').textContent = isDark ? 'â˜€ï¸' : 'ðŸŒ™';
    }

    // Load dark mode preference
    if (localStorage.getItem('darkMode') === 'true') {
      document.documentElement.classList.add('dark');
    }

    // Color conversion utilities
    function hslToRgb(h, s, l) {
      h = parseInt(h);
      s = parseInt(s);
      l = parseInt(l);
      s /= 100;
      l /= 100;

      const k = n => (n + h / 30) % 12;
      const a = s * Math.min(l, 1 - l);
      const f = n => l - a * Math.max(-1, Math.min(k(n) - 3, Math.min(9 - k(n), 1)));

      return [
        Math.round(255 * f(0)),
        Math.round(255 * f(8)),
        Math.round(255 * f(4))
      ];
    }

    function rgbToHex(rgb) {
      return '#' + rgb.map(x => {
        const hex = x.toString(16);
        return hex.length === 1 ? '0' + hex : hex;
      }).join('').toUpperCase();
    }

    function hexToHsl(hex) {
      let r = parseInt(hex.slice(1, 3), 16) / 255;
      let g = parseInt(hex.slice(3, 5), 16) / 255;
      let b = parseInt(hex.slice(5, 7), 16) / 255;

      let max = Math.max(r, g, b);
      let min = Math.min(r, g, b);
      let h, s, l = (max + min) / 2;

      if (max === min) {
        h = s = 0;
      } else {
        let d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);

        switch (max) {
          case r: h = (g - b) / d + (g < b ? 6 : 0); break;
          case g: h = (b - r) / d + 2; break;
          case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
      }

      return [
        Math.round(h * 360),
        Math.round(s * 100),
        Math.round(l * 100)
      ];
    }

    function hslToHex(h, s, l) {
      const rgb = hslToRgb(h, s, l);
      return rgbToHex(rgb);
    }

    // Initialize on load
    window.addEventListener('load', init);

    // Save theme on change
    const originalUpdateColor = updateColor;
    window.updateColor = function(key, value) {
      originalUpdateColor(key, value);
      saveThemeToStorage();
    };
  </script>
</body>
</html>
